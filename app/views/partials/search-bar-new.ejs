<!-- Barra de pesquisa-->
 
<link rel="stylesheet" href="css/search-bar.css">
<link rel="stylesheet" href="css/filtro.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
 
<section class="search-bar">
    <form id="search-form" method="GET" action="/encontre-escolas">
    <section class="search-fields">
    <input type="text" id="nome-escola-search" name="nome-escola-search" placeholder="Nome da Escola" class="A" value="<%= typeof searchParams !== 'undefined' && searchParams ? searchParams.nome : '' %>">
    <select name="regiao-search" id="regiao-search" class="A">
        <option value="regiao">Região</option>
        <option value="RNO" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.regiao === 'RNO' ? 'selected' : '' %>>Norte</option>
        <option value="RND" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.regiao === 'RND' ? 'selected' : '' %>>Nordeste</option>
        <option value="RCE" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.regiao === 'RCE' ? 'selected' : '' %>>Centro-Oeste</option>
        <option value="RSD" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.regiao === 'RSD' ? 'selected' : '' %>>Sudeste</option>
        <option value="RSU" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.regiao === 'RSU' ? 'selected' : '' %>>Sul</option>
    </select>
        <input type="text" id="cidade-search" name="cidade-search" placeholder="Cidade" class="A" value="<%= typeof searchParams !== 'undefined' && searchParams ? searchParams.cidade : '' %>">
    <br></section>
    <section class="justify">
   <button type="submit" value="" id="search">Pesquisar</button>
   </form>
 
   <script src="js/double-slider.js"></script>
 
 
   <section id="filtro">
   <h4 id="filtros"  name="filtros">Filtros</h4>
 
<section class="filter-schools" id="panel">
   <form id="filter-form" method="GET" action="/encontre-escolas">
 
   <section id="escolaridade" class="sec">
       <h4 id="niveis-de-ensino"> Níveis de Ensino</h4>
       <ul>
       <li><input type="checkbox" name="niveis" id="edu-inf" value="Educação Infantil" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.niveis && searchParams.niveis.includes('Educação Infantil') ? 'checked' : '' %>><label for="edu-inf">Educação Infantil</label></li>
       <li><input type="checkbox" name="niveis" id="fund1" value="Ensino Fundamental I" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.niveis && searchParams.niveis.includes('Ensino Fundamental I') ? 'checked' : '' %>><label for="fund1">Ensino Fundamental I</label></li>
       <li><input type="checkbox" name="niveis" id="fund2" value="Ensino Fundamental II" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.niveis && searchParams.niveis.includes('Ensino Fundamental II') ? 'checked' : '' %>><label for="fund2">Ensino Fundamental II</label></li>
       <li><input type="checkbox" name="niveis" id="e-med" value="Ensino Médio" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.niveis && searchParams.niveis.includes('Ensino Médio') ? 'checked' : '' %>><label for="e-med">Ensino Médio</label></li>
       <li><input type="checkbox" name="niveis" id="e-int" value="Educação Integrada" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.niveis && searchParams.niveis.includes('Educação Integrada') ? 'checked' : '' %>><label for="e-int">Ensino Integrado</label></li>
       <li><input type="checkbox" name="niveis" id="e-tec" value="Cursos Técnicos" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.niveis && searchParams.niveis.includes('Cursos Técnicos') ? 'checked' : '' %>><label for="e-tec">Cursos Técnicos</label></li>
       <li><input type="checkbox" name="niveis" id="cursos" value="Cursos Extracurriculares" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.niveis && searchParams.niveis.includes('Cursos Extracurriculares') ? 'checked' : '' %>><label for="cursos">Cursos Extracurriculares</label></li>
       </ul>
       </section>
 
   <section id="rede" class="sec">
       <h4 id="rede-escolar"> Rede</h4>
       <ul>
       <li><input type="checkbox" name="redes" id="municipal" value="Municipal" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.redes && searchParams.redes.includes('Municipal') ? 'checked' : '' %>><label for="municipal">Municipal</label></li>
       <li><input type="checkbox" name="redes" id="estadual" value="Estadual" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.redes && searchParams.redes.includes('Estadual') ? 'checked' : '' %>><label for="estadual">Estadual</label></li>
       <li><input type="checkbox" name="redes" id="privada" value="Privada" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.redes && searchParams.redes.includes('Privada') ? 'checked' : '' %>><label for="privada">Privada</label></li>
           <!-- <ul>
 
 
               <section class="range-slider"><h4 id="mens">Mensalidade</h6>
                   <span class="range-input">
 
                       <section class="range-price">
                           <label for="min">Min</label>
                           <input type="number" name="min" value="300"> <br>
                           <label for="max">Max</label>
                           <input type="number" name="max" value="700">
                         </section>
 
 
                   <input type="checkbox" name="bes" id="bes"><label for="bes">Bolsa de Estudos</label>
               </section>
 
           </ul>
       </ul> -->
   </section>
 
   <section id="periodo" class="sec">
       <h4 id="turno"> Turno</h4>
       <ul>
       <li><input type="checkbox" name="turnos" id="manha" value="Manhã" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.turnos && searchParams.turnos.includes('Manhã') ? 'checked' : '' %>><label for="manha">Matutino</label></li>
       <li><input type="checkbox" name="turnos" id="tarde" value="Tarde" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.turnos && searchParams.turnos.includes('Tarde') ? 'checked' : '' %>><label for="tarde">Vespertino</label></li>
       <li><input type="checkbox" name="turnos" id="integral" value="Integral" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.turnos && searchParams.turnos.includes('Integral') ? 'checked' : '' %>><label for="integral">Integral</label></li>
       <li><input type="checkbox" name="turnos" id="noite" value="Noturno" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.turnos && searchParams.turnos.includes('Noturno') ? 'checked' : '' %>><label for="noite">Noturno</label></li>
       </ul>
   </section>
 
   <section id="acessibilidade" class="sec">
       <h4 id="acessibilidade-toggle" class="collapsible-toggle">Acessibilidade</h4>
       <ul class="collapsible-content" id="acessibilidade-list">
           <p class="label-campo" style="margin-top: 5%">Acessibilidade Física</p>
           <li><input type="checkbox" name="acessibilidade" id="ramp" value="RAMP" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.acessibilidade && searchParams.acessibilidade.includes('RAMP') ? 'checked' : '' %>><label for="ramp">Rampa de Acesso</label></li>
           <li><input type="checkbox" name="acessibilidade" id="corr" value="CORR" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.acessibilidade && searchParams.acessibilidade.includes('CORR') ? 'checked' : '' %>><label for="corr">Corrimão em Escadas e Rampas</label></li>
           <li><input type="checkbox" name="acessibilidade" id="brap" value="BRAP" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.acessibilidade && searchParams.acessibilidade.includes('BRAP') ? 'checked' : '' %>><label for="brap">Banheiro Adaptado</label></li>
           <li><input type="checkbox" name="acessibilidade" id="elev" value="ELEV" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.acessibilidade && searchParams.acessibilidade.includes('ELEV') ? 'checked' : '' %>><label for="elev">Elevador ou Plataforma Elevatória</label></li>
           <li><input type="checkbox" name="acessibilidade" id="pstl" value="PSTL" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.acessibilidade && searchParams.acessibilidade.includes('PSTL') ? 'checked' : '' %>><label for="pstl">Piso Tátil</label></li>
           <li><input type="checkbox" name="acessibilidade" id="vaga" value="VAGA" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.acessibilidade && searchParams.acessibilidade.includes('VAGA') ? 'checked' : '' %>><label for="vaga">Vaga Reservada para PcD</label></li>

           <p class="label-campo" style="margin-top: 5%">Acessibilidade Comunicacional</p>
           <li><input type="checkbox" name="acessibilidade" id="libras" value="Libras" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.acessibilidade && searchParams.acessibilidade.includes('Libras') ? 'checked' : '' %>><label for="libras">Intérprete de Libras</label></li>
           <li><input type="checkbox" name="acessibilidade" id="sibr" value="SIBR" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.acessibilidade && searchParams.acessibilidade.includes('SIBR') ? 'checked' : '' %>><label for="sibr">Sinalização em Braille</label></li>
           <li><input type="checkbox" name="acessibilidade" id="alvs" value="ALVS" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.acessibilidade && searchParams.acessibilidade.includes('ALVS') ? 'checked' : '' %>><label for="alvs">Alarmes Visuais e Sonoros</label></li>
           <li><input type="checkbox" name="acessibilidade" id="vidl" value="VIDL" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.acessibilidade && searchParams.acessibilidade.includes('VIDL') ? 'checked' : '' %>><label for="vidl">Vídeos Legendados</label></li>

           <p class="label-campo" style="margin-top: 5%">Acessibilidade Pedagógica</p>
           <li><input type="checkbox" name="acessibilidade" id="aee" value="AEE" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.acessibilidade && searchParams.acessibilidade.includes('AEE') ? 'checked' : '' %>><label for="aee">AEE (Atendimento Educacional Especializado)</label></li>
           <li><input type="checkbox" name="acessibilidade" id="mada" value="MADA" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.acessibilidade && searchParams.acessibilidade.includes('MADA') ? 'checked' : '' %>><label for="mada">Materiais Didáticos Adaptados</label></li>
           <li><input type="checkbox" name="acessibilidade" id="avad" value="AVAD" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.acessibilidade && searchParams.acessibilidade.includes('AVAD') ? 'checked' : '' %>><label for="avad">Avaliações Adaptadas</label></li>
           <li><input type="checkbox" name="acessibilidade" id="tnas" value="TNAS" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.acessibilidade && searchParams.acessibilidade.includes('TNAS') ? 'checked' : '' %>><label for="tnas">Tecnologias Assistivas</label></li>
           <li><input type="checkbox" name="acessibilidade" id="acat" value="ACAT" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.acessibilidade && searchParams.acessibilidade.includes('ACAT') ? 'checked' : '' %>><label for="acat">Acessibilidade Atitudinal (Conscientização e Inclusão)</label></li>
       </ul>
   </section>
 
   <p><button type="submit" id="filtrar"> Filtrar </button></p>
   </form></section>
</section></section>
 
</section>
 
<script>
document.addEventListener('DOMContentLoaded', function() {
    const searchForm = document.getElementById('search-form');
    const searchButton = document.getElementById('search');
 
    // Handle search form submission
    searchForm.addEventListener('submit', function(e) {
        e.preventDefault();
 
        const formData = new FormData(searchForm);
        const params = new URLSearchParams();
 
        // Add search parameters
        const nomeEscola = formData.get('nome-escola-search');
        const regiao = formData.get('regiao-search');
        const cidade = formData.get('cidade-search');
 
        if (nomeEscola && nomeEscola.trim()) {
            params.append('nome', nomeEscola.trim());
        }
        if (regiao && regiao !== 'regiao') {
            params.append('regiao', regiao);
        }
        if (cidade && cidade.trim()) {
            params.append('cidade', cidade.trim());
        }
 
        // Redirect to the search URL
        const searchUrl = '/encontre-escolas' + (params.toString() ? '?' + params.toString() : '');
        window.location.href = searchUrl;
    });
 
    // Add visual feedback for search button
    searchButton.addEventListener('click', function() {
        this.innerHTML = '🔍 Buscando...';
        this.disabled = true;
        searchForm.submit();
    });
});
</script>
 
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const filtrosButton = document.getElementById('filtros');
        const filterPanel = document.getElementById('panel');
        const filterForm = document.getElementById('filter-form');
        const filtrarButton = document.getElementById('filtrar');
   
        // Toggle filter panel visibility
        filtrosButton.addEventListener('click', function(e) {
            e.preventDefault();
            if (filterPanel.style.display === 'none' || filterPanel.style.display === '') {
                filterPanel.style.display = 'block';
            } else {
                filterPanel.style.display = 'none';
            }
        });
   
        // Handle filter form submission
        filterForm.addEventListener('submit', function(e) {
            e.preventDefault();
   
            const formData = new FormData(filterForm);
            const params = new URLSearchParams();
   
            // Add existing search parameters if any
            const urlParams = new URLSearchParams(window.location.search);
            urlParams.forEach((value, key) => {
                if (key !== 'pagina') { // Don't include pagination
                    params.append(key, value);
                }
            });
   
            // Add filter parameters
            const niveis = formData.getAll('niveis');
            const redes = formData.getAll('redes');
            const turnos = formData.getAll('turnos');
   
            niveis.forEach(nivel => params.append('niveis', nivel));
            redes.forEach(rede => params.append('redes', rede));
            turnos.forEach(turno => params.append('turnos', turno));
   
            // Add accessibility filters as array
            const acessibilidade = formData.getAll('acessibilidade');
            acessibilidade.forEach(acel => params.append('acessibilidade', acel));
   
            // Redirect to filtered results
            const filterUrl = '/encontre-escolas' + (params.toString() ? '?' + params.toString() : '');
            window.location.href = filterUrl;
        });
   
        // Add visual feedback for filter button
        filtrarButton.addEventListener('click', function() {
            this.innerHTML = 'Filtrando...';
            this.disabled = true;
            filterForm.submit();
        });

        // Toggle accessibility section
        const acessibilidadeToggle = document.getElementById('acessibilidade-toggle');
        const acessibilidadeList = document.getElementById('acessibilidade-list');

        acessibilidadeToggle.addEventListener('click', function(e) {
            e.preventDefault();
            if (acessibilidadeList.style.display === 'none' || acessibilidadeList.style.display === '') {
                acessibilidadeList.style.display = 'block';
                acessibilidadeToggle.classList.add('open');
            } else {
                acessibilidadeList.style.display = 'none';
                acessibilidadeToggle.classList.remove('open');
            }
        });
    });
    </script>
