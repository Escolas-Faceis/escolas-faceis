<!-- Barra de pesquisa-->
 
<link rel="stylesheet" href="css/search-bar.css">
<link rel="stylesheet" href="css/filtro.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script src="slide.js"></script>
 
<section class="search-bar">
    <form id="search-form" method="GET" action="/encontre-escolas">
    <section class="search-fields">
    <input type="text" id="nome-escola-search" name="nome-escola-search" placeholder="Nome da Escola" class="A" value="<%= typeof searchParams !== 'undefined' && searchParams ? searchParams.nome : '' %>">
    <select name="regiao-search" id="regiao-search" class="A">
        <option value="regiao">Regi√£o</option>
        <option value="RNO" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.regiao === 'RNO' ? 'selected' : '' %>>Norte</option>
        <option value="RND" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.regiao === 'RND' ? 'selected' : '' %>>Nordeste</option>
        <option value="RCE" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.regiao === 'RCE' ? 'selected' : '' %>>Centro-Oeste</option>
        <option value="RSD" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.regiao === 'RSD' ? 'selected' : '' %>>Sudeste</option>
        <option value="RSU" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.regiao === 'RSU' ? 'selected' : '' %>>Sul</option>
    </select>
        <input type="text" id="cidade-search" name="cidade-search" placeholder="Cidade" class="A" value="<%= typeof searchParams !== 'undefined' && searchParams ? searchParams.cidade : '' %>">
    <br></section>
    <section class="justify">
   <button type="submit" value="" id="search">Pesquisar</button>
   </form>
 
   <script src="js/double-slider.js"></script>
   <script src="js/slide.js"></script>
 
 
   <section id="filtro">
   <h4 id="filtros"  name="filtros">Filtros</h4>
 
<section class="filter-schools" id="panel">
   <form id="filter-form" method="GET" action="/encontre-escolas">
 
   <section id="escolaridade" class="sec">
       <h4 id="niveis-de-ensino"> N√≠veis de Ensino</h4>
       <ul>
       <li><input type="checkbox" name="niveis" id="edu-inf" value="Educa√ß√£o Infantil" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.niveis && searchParams.niveis.includes('Educa√ß√£o Infantil') ? 'checked' : '' %>><label for="edu-inf">Educa√ß√£o Infantil</label></li>
       <li><input type="checkbox" name="niveis" id="fund1" value="Ensino Fundamental I" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.niveis && searchParams.niveis.includes('Ensino Fundamental I') ? 'checked' : '' %>><label for="fund1">Ensino Fundamental I</label></li>
       <li><input type="checkbox" name="niveis" id="fund2" value="Ensino Fundamental II" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.niveis && searchParams.niveis.includes('Ensino Fundamental II') ? 'checked' : '' %>><label for="fund2">Ensino Fundamental II</label></li>
       <li><input type="checkbox" name="niveis" id="e-med" value="Ensino M√©dio" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.niveis && searchParams.niveis.includes('Ensino M√©dio') ? 'checked' : '' %>><label for="e-med">Ensino M√©dio</label></li>
       <li><input type="checkbox" name="niveis" id="e-int" value="Educa√ß√£o Integrada" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.niveis && searchParams.niveis.includes('Educa√ß√£o Integrada') ? 'checked' : '' %>><label for="e-int">Ensino Integrado</label></li>
       <li><input type="checkbox" name="niveis" id="e-tec" value="Cursos T√©cnicos" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.niveis && searchParams.niveis.includes('Cursos T√©cnicos') ? 'checked' : '' %>><label for="e-tec">Cursos T√©cnicos</label></li>
       <li><input type="checkbox" name="niveis" id="cursos" value="Cursos Extracurriculares" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.niveis && searchParams.niveis.includes('Cursos Extracurriculares') ? 'checked' : '' %>><label for="cursos">Cursos Extracurriculares</label></li>
       </ul>
       </section>
 
   <section id="rede" class="sec">
       <h4 id="rede-escolar"> Rede</h4>
       <ul>
       <li><input type="checkbox" name="redes" id="municipal" value="Municipal" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.redes && searchParams.redes.includes('Municipal') ? 'checked' : '' %>><label for="municipal">Municipal</label></li>
       <li><input type="checkbox" name="redes" id="estadual" value="Estadual" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.redes && searchParams.redes.includes('Estadual') ? 'checked' : '' %>><label for="estadual">Estadual</label></li>
       <li><input type="checkbox" name="redes" id="fundacao" value="Funda√ß√£o/Instituto" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.redes && searchParams.redes.includes('Funda√ß√£o/Instituto') ? 'checked' : '' %>><label for="fundacao">Funda√ß√£o/Instituto</label></li>
       <li><input type="checkbox" name="redes" id="privada" value="Privada" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.redes && searchParams.redes.includes('Privada') ? 'checked' : '' %>><label for="privada">Privada</label></li>
           <ul>
 
 
               <section class="range-slider"><h4 id="mens">Mensalidade</h6>
                   <span class="range-input">
 
                       <section class="range-price">
                           <label for="min">Min</label>
                           <input type="number" name="min" value="300"> <br>
                           <label for="max">Max</label>
                           <input type="number" name="max" value="700">
                         </section>
 
 
                   <input type="checkbox" name="bes" id="bes"><label for="bes">Bolsa de Estudos</label>
               </section>
 
           </ul>
       </ul>
   </section>
 
   <section id="periodo" class="sec">
       <h4 id="turno"> Turno</h4>
       <ul>
       <li><input type="checkbox" name="turnos" id="manha" value="Manh√£" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.turnos && searchParams.turnos.includes('Manh√£') ? 'checked' : '' %>><label for="manha">Manh√£</label></li>
       <li><input type="checkbox" name="turnos" id="tarde" value="Tarde" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.turnos && searchParams.turnos.includes('Tarde') ? 'checked' : '' %>><label for="tarde">Tarde</label></li>
       <li><input type="checkbox" name="turnos" id="integral" value="Integral" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.turnos && searchParams.turnos.includes('Integral') ? 'checked' : '' %>><label for="integral">Integral</label></li>
       <li><input type="checkbox" name="turnos" id="noite" value="Noturno" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.turnos && searchParams.turnos.includes('Noturno') ? 'checked' : '' %>><label for="noite">Noturno</label></li>
       </ul>
   </section>
 
   <section id="outro" class="sec">
       <h4 id="outros">Outros</h4>
       <ul>
       <li><input type="checkbox" name="acessibilidade" id="ace" value="true" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.acessibilidade === 'true' ? 'checked' : '' %>><label for="ace">Acessibilidade</label></li>
       <li><input type="checkbox" name="eja" id="eja" value="true" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.eja === 'true' ? 'checked' : '' %>><label for="eja">EJA</label></li>
       <li><input type="checkbox" name="bilingue" id="bilingue" value="true" <%= typeof searchParams !== 'undefined' && searchParams && searchParams.bilingue === 'true' ? 'checked' : '' %>><label for="bilingue">Escola Bilingue</label></li>
       </ul>
   </section>
 
   <p><button type="submit" id="filtrar"> Filtrar </button></p>
   </form></section>
</section></section>
 
</section>
 
<script>
document.addEventListener('DOMContentLoaded', function() {
    const searchForm = document.getElementById('search-form');
    const searchButton = document.getElementById('search');
 
    // Handle search form submission
    searchForm.addEventListener('submit', function(e) {
        e.preventDefault();
 
        const formData = new FormData(searchForm);
        const params = new URLSearchParams();
 
        // Add search parameters
        const nomeEscola = formData.get('nome-escola-search');
        const regiao = formData.get('regiao-search');
        const cidade = formData.get('cidade-search');
 
        if (nomeEscola && nomeEscola.trim()) {
            params.append('nome', nomeEscola.trim());
        }
        if (regiao && regiao !== 'regiao') {
            params.append('regiao', regiao);
        }
        if (cidade && cidade.trim()) {
            params.append('cidade', cidade.trim());
        }
 
        // Redirect to the search URL
        const searchUrl = '/encontre-escolas' + (params.toString() ? '?' + params.toString() : '');
        window.location.href = searchUrl;
    });
 
    // Add visual feedback for search button
    searchButton.addEventListener('click', function() {
        this.innerHTML = 'üîç Buscando...';
        this.disabled = true;
        searchForm.submit();
    });
});
</script>
 
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const filtrosButton = document.getElementById('filtros');
        const filterPanel = document.getElementById('panel');
        const filterForm = document.getElementById('filter-form');
        const filtrarButton = document.getElementById('filtrar');
   
        // Toggle filter panel visibility
        filtrosButton.addEventListener('click', function(e) {
            e.preventDefault();
            if (filterPanel.style.display === 'none' || filterPanel.style.display === '') {
                filterPanel.style.display = 'block';
            } else {
                filterPanel.style.display = 'none';
            }
        });
   
        // Handle filter form submission
        filterForm.addEventListener('submit', function(e) {
            e.preventDefault();
   
            const formData = new FormData(filterForm);
            const params = new URLSearchParams();
   
            // Add existing search parameters if any
            const urlParams = new URLSearchParams(window.location.search);
            urlParams.forEach((value, key) => {
                if (key !== 'pagina') { // Don't include pagination
                    params.append(key, value);
                }
            });
   
            // Add filter parameters
            const niveis = formData.getAll('niveis');
            const redes = formData.getAll('redes');
            const turnos = formData.getAll('turnos');
   
            niveis.forEach(nivel => params.append('niveis', nivel));
            redes.forEach(rede => params.append('redes', rede));
            turnos.forEach(turno => params.append('turnos', turno));
   
            // Add boolean filters
            if (formData.get('acessibilidade')) params.append('acessibilidade', 'true');
            if (formData.get('eja')) params.append('eja', 'true');
            if (formData.get('bilingue')) params.append('bilingue', 'true');
   
            // Redirect to filtered results
            const filterUrl = '/encontre-escolas' + (params.toString() ? '?' + params.toString() : '');
            window.location.href = filterUrl;
        });
   
        // Add visual feedback for filter button
        filtrarButton.addEventListener('click', function() {
            this.innerHTML = 'Filtrando...';
            this.disabled = true;
            filterForm.submit();
        });
    });
    </script>